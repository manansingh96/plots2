<%# <div class="col-md-3"> %>
<%#     <h4> About this page </h4> %>
<%#     <p> There is a lot of content being added to the website everyday. In this page you can select a range to see the statistics of different types of content on the website within that range </p> %>
<%#     <%= render 'stats_nav' %1> %>
<%# </div> %>
<div class="col-md-8 col-md-offset-1">
    </p>
    <%= form_tag request.url, method: 'get' do %>
        <div class="row">
            <div class="col-md-8">
                <h5> Date Range </h5>
                <%= select_tag :options, options_for_select(["Week", "Month","Year"]), prompt: "Choose a period to view statistics for",
                    class: " form-control input-lg", onchange: "this.form.submit();" %>
        </div>
        </div>
        <br>
        <div class="row">
            <div class="col-md-4">
                <label>Starting</label>
                <input data-provide="datepicker" data-date="<%= DateTime.now.strftime("%d-%m-%Y") %>" data-date-format="dd-mm-yyyy" tabindex="1" class="form-control input-lg" type="text" name="start" placeholder="Start date">
            </div>
            <div class="col-md-4">
                <label>Ending</label>
                <input data-provide="datepicker" data-date="<%= DateTime.now.strftime("%d-%m-%Y") %>" data-date-format="dd-mm-yyyy" tabindex="1" class="form-control input-lg" type="text" name="end" placeholder="End date">
            </div>
            <div class="col-md-1">
                <%= submit_tag "Go" , class: 'btn btn-primary', :style=>'margin-top:2em;'  %>
            </div>
        </div>
    <% end %>
    <hr />
    <h4>
        <%= raw t('notes.stats.notes_wikis_comments', :notes_count => @notes, :wikis_count => @wikis, :comments_count => @comments) %>
    </h4>
    <hr>
    <h4>
      <%= raw t('notes.stats.members_and_contributors', :member_count => @people, :people_count => @contributors) %>
    </h4>
    <hr>
    <h4>
    <%= @questions.count %> questions asked and  <%= @answers %> questions answered during this period
    </h4>
    <hr>
    <p><i>Member registration may include spam accounts</i></p>

    <%# <table class="table"> %>
    <%#     <tr> %>
    <%#         <td><%= @notes %1></td> %>
    <%#         <td>notes in this period</td> %>
    <%#     </tr> %>
    <%#     <tr> %>
    <%#         <%= @wikis %1></td> %>
    <%#     wiki edits in this period</td> %>
    <%#     </tr> %>
    <%#     <tr> %>
    <%#         <td><%= @people %1></td> %>
    <%#         <td>new member registrations in this period</td> %>
    <%#     </tr> %>
    <%#     <tr> %>
    <%#         <td><%= @answers %1></td> %>
    <%#         <td>answers posted in this period</td> %>
    <%#     </tr> %>
    <%#     <tr> %>
    <%#         <td><%= @comments %1></td> %>
    <%#         <td>comments posted in this period</td> %>
    <%#     </tr> %>
    <%#     <tr> %>
    <%#         <td><%= @questions.count %1></td> %>
    <%#         <td>questions posted in this period</td> %>
    <%#     </tr> %>
    <%#     <tr> %>
    <%#         <td><%= @contributors %1></td> %>
    <%#         <td>contributors in this period</td> %>
    <%#     </tr> %>
    <%# </table> %>

    <% if current_user && (current_user.role == "admin") %>
        <br>

        <div class="btn-group">
            <button type="button" class="btn btn-lg btn-default">
                <i class="fa fa-cloud-download" style="color:blue"> </i>
                Download as json
            </button>
            <button type="button" class="btn btn-lg btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <span class="caret"></span>
                <span class="sr-only">Toggle Dropdown</span>
            </button>
            <ul class="dropdown-menu">
                <li>
                    <%= link_to "Notes", stats_notes_path(format: 'json', start: params[:start], end: params[:end]) %>
                </li>
                <li>
                    <%= link_to "Wikis", stats_wikis_path(format: 'json', start: params[:start], end: params[:end]) %>
                </li>
                <li>
                    <%= link_to "Comments", stats_comments_path(format: 'json', start: params[:start], end: params[:end]) %>
                </li>
                <li>
                    <%= link_to "Users", stats_users_path(format: 'json', start: params[:start], end: params[:end]) %>
                </li>
                <li>
                    <%= link_to "Questions Asked", stats_questions_path(format: 'json', start: params[:start], end: params[:end]) %>
                </li>
                <li>
                    <%= link_to "Questions Answered", stats_answers_path(format: 'json', start: params[:start], end: params[:end]) %>
                </li>
            </ul>
        </div>
        &ensp;
        <div class="btn-group">
            <button type="button" class="btn btn-lg btn-default">
                <i class="fa fa-cloud-download" style="color:purple"> </i>
                Download as csv
            </button>
            <button type="button" class="btn btn-lg btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <span class="caret"></span>
                <span class="sr-only">Toggle Dropdown</span>
            </button>
            <ul class="dropdown-menu">
                <li>
                    <%= link_to "Notes", stats_notes_path(format: 'csv', start: params[:start], end: params[:end]) %>
                </li>
                <li>
                    <%= link_to "Wikis", stats_wikis_path(format: 'csv', start: params[:start], end: params[:end]) %>
                </li>
                <li>
                    <li>
                        <%= link_to "Users", stats_users_path(format: 'csv', start: params[:start], end: params[:end]) %>
                    </li>
                    <li>
                        <%= link_to "Questions Asked", stats_questions_path(format: 'csv', start: params[:start], end: params[:end]) %>
                    </li>
                    <li>
                        <%= link_to "Questions Answered", stats_answers_path(format: 'csv', start: params[:start], end: params[:end]) %>
                    </li>
            </ul>
        </div>
        <br><br>
    <% end %>
    <br>


    <br>
    </div>
    <div class="col-md-10">
    <div id="chart">
    </div>
    <br>
    </div>

    <%# <p> Move back or forward using the buttons below </p> %>
    <%# <div class="btn-group" role="group" aria-label="Basic example"> %>
    <%#     <a href="/stats/range/<%= (@start - 1.year).to_formatted_s(:long)   %1>/<%= (@end - 1.year).to_formatted_s(:long)   %1>"> %>
    <%#         <button type="button" class="btn btn-secondary" title= "1 year back"> %>
    <%#             <i class="fa fa-caret-left fa-2x"  style="color:#3071a9;"> </i> %>
    <%#             <i class="fa fa-caret-left fa-2x"  style="color:#3071a9;"> </i> %>
    <%#             <i class="fa fa-caret-left fa-2x"  style="color:#3071a9;"> </i> %>
    <%#             <i class="fa fa-caret-left fa-2x"  style="color:#3071a9;"> </i> %>
    <%#         </button> %>
    <%#     </a> %>
    <%#     <a href="/stats/range/<%= (@start - 3.months).to_formatted_s(:long) %1>/<%= (@end - 3.months).to_formatted_s(:long) %1>"> %>
    <%#         <button type="button" class="btn btn-secondary" title="3 months back"> %>
    <%#             <i class="fa fa-caret-left fa-2x"  style="color:#3071a9;"> </i> %>
    <%#             <i class="fa fa-caret-left fa-2x"  style="color:#3071a9;"> </i> %>
    <%#             <i class="fa fa-caret-left fa-2x"  style="color:#3071a9;"> </i> %>
    <%#         </button> %>
    <%#     </a> %>
    <%#     <a href="/stats/range/<%= (@start - 1.month).to_formatted_s(:long)  %1>/<%= (@end - 1.month).to_formatted_s(:long)  %1>"> %>
    <%#         <button type="button" class="btn btn-secondary" title="1 month back"> %>
    <%#             <i class="fa fa-caret-left fa-2x"  style="color:#3071a9;"> </i> %>
    <%#             <i class="fa fa-caret-left fa-2x"  style="color:#3071a9;"> </i> %>
    <%#         </button> %>
    <%#     </a> %>
    <%#     <a href="/stats/range/<%= (@start - 1.week).to_formatted_s(:long)   %1>/<%= (@end - 1.week).to_formatted_s(:long)   %1>"> %>
    <%#         <button type="button" class="btn btn-secondary" title="1 week back"> %>
    <%#             <i class="fa fa-caret-left fa-2x"  style="color:#3071a9;"> </i> %>
    <%#         </button> %>
    <%#     </a> %>
    <%# </div> %>

    <%# &emsp;&emsp; %>
    <%# <div class="btn-group" role="group" aria-label="Basic example"> %>
    <%#     <a href="/stats/range/<%= (@start + 1.week).to_formatted_s(:long)   %1>/<%= (@end + 1.week).to_formatted_s(:long)   %1>"> %>
    <%#         <button type="button" class="btn btn-secondary" title="1 week forward"> %>
    <%#             <i class="fa fa-caret-right fa-2x"  style="color:#3071a9;"> </i> %>
    <%#         </button> %>
    <%#     </a> %>
    <%#     <a href="/stats/range/<%= (@start + 1.month).to_formatted_s(:long)  %1>/<%= (@end + 1.month).to_formatted_s(:long)  %1>"> %>
    <%#         <button type="button" class="btn btn-secondary" title="1 month forward"> %>
    <%#             <i class="fa fa-caret-right fa-2x"  style="color:#3071a9;"> </i> %>
    <%#             <i class="fa fa-caret-right fa-2x"  style="color:#3071a9;"> </i> %>
    <%#         </button> %>
    <%#     </a> %>
    <%#     <a href="/stats/range/<%= (@start + 3.months).to_formatted_s(:long) %1>/<%= (@end + 3.months).to_formatted_s(:long) %1>" > %>
    <%#         <button type="button" class="btn btn-secondary" title="3 months forward"> %>
    <%#             <i class="fa fa-caret-right fa-2x"  style="color:#3071a9;"> </i> %>
    <%#             <i class="fa fa-caret-right fa-2x"  style="color:#3071a9;"> </i> %>
    <%#             <i class="fa fa-caret-right fa-2x"  style="color:#3071a9;"> </i> %>
    <%#         </button> %>
    <%#     </a> %>
    <%#     <a href="/stats/range/<%= (@start + 1.year).to_formatted_s(:long)   %1>/<%= (@end + 1.year).to_formatted_s(:long)   %1>"> %>
    <%#         <button type="button" class="btn btn-secondary" title="1 year forward"> %>
    <%#             <i class="fa fa-caret-right fa-2x"  style="color:#3071a9;"> </i> %>
    <%#             <i class="fa fa-caret-right fa-2x"  style="color:#3071a9;"> </i> %>
    <%#             <i class="fa fa-caret-right fa-2x"  style="color:#3071a9;"> </i> %>
    <%#             <i class="fa fa-caret-right fa-2x"  style="color:#3071a9;"> </i> %>
    <%#         </button> %>
    <%#     </a> %>
    <%# </div> %>
<%# </div> %>

<script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
<script>
var values =  <%=  @popular_tags.values %>;
var data =  <%= raw (@popular_tags.keys) %>;

var options = {
    chart: {
        height: 400,
        type: 'bar',

    },
    colors: ['#006dcc'],
    plotOptions: {
        bar: {
            horizontal: true,

        }

    },

    dataLabels: {
        enabled: false

    },
    series: [{
        name: 'Tag count',
        data: values

    }],
    title:{
        text: "Popular Tags in this period",
    },
    xaxis: {
        categories: data

    }

}

var chart = new ApexCharts(
        document.querySelector("#chart"), options );
chart.render();

</script>
